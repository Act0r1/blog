---
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post: CollectionEntry<'blog'>) => ({
		params: { slug: post.slug },
		props: post,
	}));
}
type Props = CollectionEntry<'blog'>;

const post = Astro.props;
const { Content, remarkPluginFrontmatter } = await post.render();

const formattedDate = post.data.pubDate.toLocaleDateString('ru-RU', {
	year: 'numeric',
	month: 'long',
	day: 'numeric',
});
---

<Layout title={`insafdev | ${post.data.title}`}>
	<article class="py-8 mt-4">
		<header class="mb-10">
			<a href="/" class="text-zinc-500 hover:text-white transition-colors mb-8 inline-block">
				← Назад
			</a>
			
			<h1 class="text-4xl sm:text-5xl font-bold tracking-tight text-zinc-100 mb-4 leading-tight">
				{post.data.title}
			</h1>
			
			<div class="flex flex-wrap items-center gap-4 text-zinc-400">
				<time datetime={post.data.pubDate.toISOString()}>
					{formattedDate}
				</time>
				
				<span class="text-zinc-600">•</span>
				
				<span>
					{remarkPluginFrontmatter.minutesRead}
				</span>
				
				{post.data.tags.length > 0 && (
					<>
						<span class="text-zinc-600">•</span>
						<div class="flex gap-2">
							{post.data.tags.map((tag: string) => (
								<a href={`/tags/${tag}`} class="bg-zinc-800/50 text-zinc-300 px-2 py-0.5 rounded-md text-sm border border-zinc-700/50 hover:border-zinc-500 hover:text-white transition-colors">
									#{tag}
								</a>
							))}
						</div>
					</>
				)}
			</div>
		</header>
		
		<div class="prose prose-invert prose-zinc max-w-none prose-headings:font-bold prose-a:text-blue-400 prose-a:no-underline hover:prose-a:underline">
			<Content />
		</div>
	</article>
</Layout>